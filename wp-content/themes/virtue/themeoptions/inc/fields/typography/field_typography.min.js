(function(c){redux.field_objects=redux.field_objects||{};redux.field_objects.typography=redux.field_objects.typography||{};var d=[];var a=false;var b={width:"resolve",triggerChange:true,allowClear:true};c(document).ready(function(){});redux.field_objects.typography.init=function(e){if(!e){e=c(document).find(".redux-group-tab:visible").find(".redux-container-typography:visible")}c(e).each(function(){var h=c(this);var g=h;if(!h.hasClass("redux-field-container")){g=h.parents(".redux-field-container:first")}if(g.is(":hidden")){return}if(g.hasClass("redux-field-init")){g.removeClass("redux-field-init")}else{return}var f;h.each(function(){c(this).find(".redux-typography-container").each(function(){var m=c(this).find(".redux-typography-family");if(m.data("value")===undefined){m=c(this)}else{if(m.data("value")!==""){c(m).val(m.data("value"))}}var k=c(this).find(".select2_params");if(k.size()>0){var l=k.val();l=JSON.parse(l);b=c.extend({},b,l)}f=Boolean(c(this).find(".redux-font-clear").val());redux.field_objects.typography.select(m);window.onbeforeunload=null});c(this).find(".redux-typography").on("change",function(){redux.field_objects.typography.select(c(this))});c(this).find(".redux-typography-size, .redux-typography-height, .redux-typography-word, .redux-typography-letter, .redux-typography-align, .redux-typography-transform, .redux-typography-font-variant, .redux-typography-decoration").keyup(function(){redux.field_objects.typography.select(c(this).parents(".redux-container-typography:first"))});c(this).find(".redux-typography-color").wpColorPicker({change:function(k,l){redux_change(c(this));c(this).val(l.color.toString());redux.field_objects.typography.select(c(this))}});c(this).find(".redux-typography-size").numeric({allowMinus:false});c(this).find(".redux-typography-height, .redux-typography-word, .redux-typography-letter").numeric({allowMinus:true});var i=[{id:"none",text:"none"}];c(this).find(".redux-typography-family").select2({matcher:function(k,l){return l.toUpperCase().indexOf(k.toUpperCase())===0},query:function(k){return window.Select2.query.local(i)(k)},initSelection:function(k,m){var l={id:k.val(),text:k.val()};m(l)},allowClear:f,}).on("select2-opening",function(q){var t=c(this).parents(".redux-container-typography:first").attr("data-id");var m=c("#"+t+" .redux-typography-font-family").data("user-fonts");m=m?1:0;var n=c("#"+t+" .redux-typography-google").val();n=n?1:0;var r=[];if(redux.customfonts!==undefined){r.push(redux.customfonts)}if(redux.stdfonts!==undefined&&m===0){r.push(redux.stdfonts)}if(m==1){var l=[];for(var u in redux.typography[t]){var p=redux.typography[t].std_font;for(var k in p){if(p.hasOwnProperty(k)){l.push({id:k,text:k,"data-google":"false"})}}}var o={text:"Standard Fonts",children:l};r.push(o)}if(n==1||n===true&&redux.googlefonts!==undefined){r.push(redux.googlefonts)}i=r;var s=c("#"+t+" #"+t+"-family").attr("placeholder");if(!s){s=null}c("#"+t+" .redux-typography-family").select2("val",s)}).on("select2-selecting",function(m,k){var l=m.object.text;var n=c(this).parents(".redux-container-typography:first").attr("data-id");c("#"+n+" #"+n+"-family").data("value",l);c("#"+n+" #"+n+"-family").attr("placeholder",l);d=m;a=true;redux_change(c(this))}).on("select2-clearing",function(l,k){var m=c(this).parents(".redux-container-typography:first").attr("data-id");c("#"+m+" #"+m+"-family").attr("data-value","");c("#"+m+" #"+m+"-family").attr("placeholder","Font Family");c("#"+m+" #"+m+"-google-font").val("false");redux_change(c(this))});var j=h.find(".redux-typography-family");if(!j.hasClass("redux-typography-family")){h.find(".redux-typography-style").select2(b)}h.find(".redux-typography-family-backup, .redux-typography-align, .redux-typography-transform, .redux-typography-font-variant, .redux-typography-decoration").select2(b)})})};redux.field_objects.typography.size=function(g){var f=0,e;for(e in g){if(g.hasOwnProperty(e)){f++}}return f};redux.field_objects.typography.makeBool=function(e){if(e=="false"||e=="0"||e===false||e===0){return false}else{if(e=="true"||e=="1"||e===true||e==1){return true}}};redux.field_objects.typography.contrastColour=function(j){var k="#444444";if(j!==""){j=j.replace("#","");var i=parseInt(j.substr(0,2),16);var h=parseInt(j.substr(2,2),16);var e=parseInt(j.substr(4,2),16);var f=((i*299)+(h*587)+(e*114))/1000;k=(f>=128)?"#444444":"#ffffff"}return k};redux.field_objects.typography.select=function(u){var e=c(u).parents(".redux-container-typography:first").attr("data-id");var z=c("#"+e+" #"+e+"-family").val();if(!z){z=null}var f=c("#"+e+" select.redux-typography-family-backup").val();var o=c("#"+e+" .redux-typography-size").val();var p=c("#"+e+" .redux-typography-height").val();var x=c("#"+e+" .redux-typography-word").val();var B=c("#"+e+" .redux-typography-letter").val();var t=c("#"+e+" select.redux-typography-align").val();var n=c("#"+e+" select.redux-typography-transform").val();var i=c("#"+e+" select.redux-typography-font-variant").val();var k=c("#"+e+" select.redux-typography-decoration").val();var w=c("#"+e+" select.redux-typography-style").val();var A=c("#"+e+" select.redux-typography-subsets").val();var s=c("#"+e+" .redux-typography-color").val();var r=c("#"+e).data("units");var g;if(a===true){g=redux.field_objects.typography.makeBool(d.object["data-google"]);c("#"+e+" .redux-typography-google-font").val(g)}else{g=redux.field_objects.typography.makeBool(c("#"+e+" .redux-typography-google-font").val())}if(!c("#"+e).hasClass("typography-initialized")){w=c("#"+e+" select.redux-typography-style").data("value");A=c("#"+e+" select.redux-typography-subsets").data("value");if(w!==""){w=String(w)}if(typeof(A)!==undefined){A=String(A)}}if(redux.fonts.google===undefined){g=false}var y="";if(g===true&&(z in redux.fonts.google)){y=redux.fonts.google[z]}else{y={"400":"Normal 400","700":"Bold 700","400italic":"Normal 400 Italic","700italic":"Bold 700 Italic"}}if(c(u).hasClass("redux-typography-subsets")){c("#"+e+" input.typography-subsets").val(A)}if(c(u).hasClass("redux-typography-family")){var m='<option value=""></option>';if(g===true){var q="";c.each(y.variants,function(C,D){if(D.id===w||redux.field_objects.typography.size(y.variants)===1){q=' selected="selected"';w=D.id}else{q=""}m+='<option value="'+D.id+'"'+q+">"+D.name.replace(/\+/g," ")+"</option>"});c("#"+e+" .redux-typography-style").select2("destroy");c("#"+e+" .redux-typography-style").html(m);c("#"+e+" .redux-typography-style").select2(b);q="";m='<option value=""></option>';c.each(y.subsets,function(C,D){if(D.id===A||redux.field_objects.typography.size(y.subsets)===1){q=' selected="selected"';A=D.id;c("#"+e+" input.typography-subsets").val(A)}else{q=""}m+='<option value="'+D.id+'"'+q+">"+D.name.replace(/\+/g," ")+"</option>"});c("#"+e+" .redux-typography-subsets").select2("destroy");c("#"+e+" .redux-typography-subsets").html(m);c("#"+e+" .redux-typography-subsets").select2(b);c("#"+e+" .redux-typography-subsets").parent().fadeIn("fast");c("#"+e+" .typography-family-backup").fadeIn("fast")}else{if(y){c.each(y,function(C,D){if(C===w||C==="normal"){q=' selected="selected"';c("#"+e+" .typography-style .select2-chosen").text(D)}else{q=""}m+='<option value="'+C+'"'+q+">"+D.replace("+"," ")+"</option>"});c("#"+e+" .redux-typography-style").select2("destroy");c("#"+e+" .redux-typography-style").html(m);c("#"+e+" .redux-typography-style").select2(b);c("#"+e+" .redux-typography-subsets").parent().fadeOut("fast");c("#"+e+" .typography-family-backup").fadeOut("fast")}}c("#"+e+" .redux-typography-font-family").val(z)}else{if(c(u).hasClass("redux-typography-family-backup")&&f!==""){c("#"+e+" .redux-typography-font-family-backup").val(f)}}if(c("#"+e+" select.redux-typography-style option[value='"+w+"']").length===0){w="";c("#"+e+" select.redux-typography-style").select2("val","")}else{if(w==="400"){c("#"+e+" select.redux-typography-style").select2("val",w)}}if(c("#"+e+" select.redux-typography-subsets option[value='"+A+"']").length===0){A="";c("#"+e+" select.redux-typography-subsets").select2("val","");c("#"+e+" input.typography-subsets").val(A)}var v="style_link_"+e;c("."+v).remove();if(z!==null&&z!=="inherit"&&c("#"+e).hasClass("typography-initialized")){var h=z.replace(/\s+/g,"+");if(g===true){var j=h;if(w&&w!==""){j+=":"+w.replace(/\-/g," ")}if(A&&A!==""){j+="&subset="+A}if(typeof(WebFont)!=="undefined"&&WebFont){WebFont.load({google:{families:[j]}})}c("#"+e+" .redux-typography-google").val(true)}else{c("#"+e+" .redux-typography-google").val(false)}}if(w.indexOf("italic")!==-1){c("#"+e+" .typography-preview").css("font-style","italic");c("#"+e+" .typography-font-style").val("italic");w=w.replace("italic","")}else{c("#"+e+" .typography-preview").css("font-style","normal");c("#"+e+" .typography-font-style").val("")}c("#"+e+" .typography-font-weight").val(w);if(!p){p=o}if(o===""){c("#"+e+" .typography-font-size").val("")}else{c("#"+e+" .typography-font-size").val(o+r)}if(p===""){c("#"+e+" .typography-line-height").val("")}else{c("#"+e+" .typography-line-height").val(p+r)}if(x===""){c("#"+e+" .typography-word-spacing").val("")}else{c("#"+e+" .typography-word-spacing").val(x+r)}if(B===""){c("#"+e+" .typography-letter-spacing").val("")}else{c("#"+e+" .typography-letter-spacing").val(B+r)}if(c("#"+e).hasClass("typography-initialized")){var l=c("#"+e+" .typography-preview").data("preview-size");if(l=="0"){c("#"+e+" .typography-preview").css("font-size",o+r)}c("#"+e+" .typography-preview").css("font-weight",w);c("#"+e+" .typography-preview").css("font-family",z+", sans-serif");if(z==="none"&&z===""){c("#"+e+" .typography-preview").css("font-family","inherit")}c("#"+e+" .typography-preview").css("line-height",p+r);c("#"+e+" .typography-preview").css("word-spacing",x+r);c("#"+e+" .typography-preview").css("letter-spacing",B+r);if(s){c("#"+e+" .typography-preview").css("color",s);c("#"+e+" .typography-preview").css("background-color",redux.field_objects.typography.contrastColour(s))}c("#"+e+" .typography-style .select2-chosen").text(c("#"+e+" .redux-typography-style option:selected").text());c("#"+e+" .typography-script .select2-chosen").text(c("#"+e+" .redux-typography-subsets option:selected").text());if(t){c("#"+e+" .typography-preview").css("text-align",t)}if(n){c("#"+e+" .typography-preview").css("text-transform",n)}if(i){c("#"+e+" .typography-preview").css("font-variant",i)}if(k){c("#"+e+" .typography-preview").css("text-decoration",k)}c("#"+e+" .typography-preview").slideDown()}if(!c("#"+e).hasClass("typography-initialized")){c("#"+e).addClass("typography-initialized")}a=false}})(jQuery);